â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                      DIAGNOZA EROARE 400 - PHANTOM PRODUCTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PROBLEMÄ‚ OBSERVATÄ‚:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Fiecare POST /products returneazÄƒ Status 400 È™i creeazÄƒ phantom IDs (5141, 5142, 5143, 5144, 5145).

LOG ERROR:
   [15:07:11] [WARNING] âš ï¸ Conflict detectat
   [15:07:11] [WARNING] ğŸ” Phantom ID creat: 5141
   [15:07:11] [INFO] ğŸ—‘ï¸ Ãncerc È™tergere AUTOMATÄ‚ phantom ID 5141...
   [15:07:13] [WARNING] âš ï¸ Delete eÈ™uat (status 404)

CAUZA REALÄ‚:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. POST /products returneazÄƒ 400 de fiecare datÄƒ
2. WooCommerce creeazÄƒ Ã®nregistrarea Ã®n wp_posts (cu ID auto_increment)
3. Inserarea Ã®n wp_wc_product_meta_lookup EÈ˜UEAZÄ‚ (fÄƒrÄƒ motiv cunoscut)
4. Rezultat: Phantom product - Ã®nregistrare incompletÄƒ Ã®n database
5. API REST DELETE returneazÄƒ 404 pentru phantom (nu vede Ã®nregistrarea incompletÄƒ)

SOLUÈšII IMPLEMENTATE:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âœ… 1. RETRY LOGIC
   - Max 5 Ã®ncercÄƒri cu UUID SKU-uri diferite
   - Fiecare retry are SKU complet diferit (evitÄƒ coliziuni)

âœ… 2. PHANTOM DETECTION
   - Extrage phantom ID din mesajul de eroare: "Duplicate entry '5141'"
   - Parseaza corect HTML entities È™i message text

âœ… 3. MULTI-STAGE DELETION
   - Nivel 1: ÃncearcÄƒ DELETE via REST API
   - Nivel 2: DacÄƒ DELETE/404, afiÈ™eazÄƒ SQL manual pentru phpMyAdmin
   - Nivel 3: UUID fallback pentru retry

âœ… 4. BETTER ERROR REPORTING
   - AfiÈ™eazÄƒ mesajul de eroare complet (nu doar "Status 400")
   - DiferenÈ›iazÄƒ Ã®ntre "Duplicate entry" È™i alte erori 400

NEXT STEPS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âŒ STOP: CurÄƒÈ›are manualÄƒ DUPÄ‚ FIECARE EROARE nu mai e necesarÄƒ!
         Programul o face automat.

âš ï¸  DAR PROBLEMA REALÄ‚ E ALTA:
    Status 400 se Ã®ntoarce pentru FIECARE POST - asta nu e normal!

TREBUIE INVESTIGAT:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

A. Validare date produs:
   - VerificÄƒ cÄƒ wc_data are toate cÃ¢mpurile obligatorii
   - VerificÄƒ tipurile de date (preÈ› trebuie sÄƒ fie string, nu float)
   - Verific encoding (UTF-8?)

B. Status WooCommerce:
   - Verific cÄƒ pluginul WooCommerce e activ
   - Verific PHP error log (wp-content/debug.log)
   - Verific database integrity

C. API Permissions:
   - Consumer Key/Secret au permisiuni complete (Read/Write)?
   - API e activat Ã®n WooCommerce settings?

D. Database State:
   - VerificÄƒ dacÄƒ tabela wp_wc_product_meta_lookup e coruptÄƒ
   - VerificÄƒ AUTO_INCREMENT Ã®n wp_posts (e la 5146?)
   - VerificÄƒ pentru FK constraints

COMENZI DE DIAGNOSTIC:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# VerificÄƒ starea database:
SELECT COUNT(*) FROM wplt_posts WHERE post_type='product';
SELECT MAX(ID) FROM wplt_posts;

# VerificÄƒ phantom IDs:
SELECT ID, post_title, post_status FROM wplt_posts WHERE ID IN (5141, 5142, 5143, 5144, 5145);

# VerificÄƒ meta_lookup:
SELECT COUNT(*) FROM wplt_wc_product_meta_lookup;
SELECT * FROM wplt_wc_product_meta_lookup WHERE product_id IN (5141, 5142, 5143, 5144, 5145);

# CurÄƒÈ›are manualÄƒ phantom IDs:
DELETE FROM wplt_postmeta WHERE post_id IN (5141, 5142, 5143, 5144, 5145);
DELETE FROM wplt_posts WHERE ID IN (5141, 5142, 5143, 5144, 5145);
ALTER TABLE wplt_posts AUTO_INCREMENT=5146;

PROGRAM IMPROVEMENTS (v3.2):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Lines modified:
âœ“ 809-880: Status 400 handling cu multiple error types
âœ“ 825-847: Auto-delete phantom cu fallback la MySQL info
âœ“ 870-882: Non-duplicate error handling cu retry

Output mai detaliat Ã®n LOG!
