â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                            â•‘
â•‘     ğŸ§¹ CURÄ‚ÈšARE AUTOMATÄ‚ - PRODUSE ORFANE ÃN WOOCOMMERCE                    â•‘
â•‘                                                                            â•‘
â•‘  PROBLEMA: Produsul ID 5081 (È™i similare) sunt PARÈšIAL CREATE             â•‘
â•‘  CAUZA: WooCommerce creeazÄƒ ID dar eÈ™ueazÄƒ la INSERT SKU Ã®n meta_lookup    â•‘
â•‘                                                                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


ğŸ”´ SITUAÈšIA ACTUALÄ‚:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

FiÈ™ierul log aratÄƒ:
  âœ— Duplicate entry '5081' for key 'PRIMARY'
  
Asta Ã®nseamnÄƒ:
  1. POST #1: CreeazÄƒ ID 5081 Ã®n wp_posts âœ“
             Dar eÈ™ueazÄƒ la INSERT sku Ã®n wp_wc_product_meta_lookup âœ—
  
  2. POST #2: ÃncearcÄƒ iarÄƒÈ™i cu alt SKU
             Auto_increment dÄƒ iarÄƒÈ™i ID 5081 (pt cÄƒ nu s-a salvat)
             Conflict PRIMARY KEY! âœ—
  
  3. POST #3: AcelaÈ™i lucru âœ—

SOLUÈšIE: È˜terge ID-ul orfan 5081 pentru a elibera locul


ğŸ› ï¸ CUM SE REZOLVÄ‚:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

METODA 1: SCRIPT PHP AUTOMAT (RECOMANDAT) â­
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. Upload scriptul pe server:
   â€¢ FiÈ™ier: curata_orfane.php
   â€¢ LocaÈ›ie: /wp-content/ pe serverul tÄƒu
   
   PENTRU WEBGSM:
   - FTP Connection (via cPanel)
   - ConecteazÄƒ-te ca admin
   - Merge la: public_html/wp-content/
   - Upload curata_orfane.php

2. RuleazÄƒ scriptul din browser:
   â€¢ URL: https://webgsm.ro/wp-content/curata_orfane.php
   
   Script-ul va:
   âœ“ GÄƒsi toate produsele fÄƒrÄƒ Ã®nregistrare Ã®n meta_lookup
   âœ“ Le È™terge automat
   âœ“ ReseteazÄƒ AUTO_INCREMENT
   âœ“ VerificÄƒ pentru SKU-uri duplicate
   âœ“ AratÄƒ raport final


METODA 2: COMMAND LINE / PHPMYADMIN (Manual)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. Deschide phpMyAdmin Ã®n cPanel
2. SelecteazÄƒ baza de date WordPress (webgsm_ro sau similar)
3. RuleazÄƒ urmÄƒtoarele comenzi:

   -- BACKUP FIRST!
   -- (cPanel â†’ phpMyAdmin â†’ Export)

   -- 1. GÄ‚SEÈ˜TE PRODUSE ORFANE
   SELECT p.ID, p.post_title 
   FROM wp_posts p
   WHERE p.post_type = 'product'
     AND NOT EXISTS (
         SELECT 1 FROM wp_wc_product_meta_lookup 
         WHERE product_id = p.ID
     );

   -- 2. È˜TERGE PRODUSELE ORFANE
   DELETE FROM wp_postmeta 
   WHERE post_id IN (
       SELECT ID FROM wp_posts 
       WHERE post_type = 'product'
         AND NOT EXISTS (
             SELECT 1 FROM wp_wc_product_meta_lookup 
             WHERE product_id = wp_posts.ID
         )
   );

   DELETE FROM wp_term_relationships 
   WHERE object_id IN (
       SELECT ID FROM wp_posts 
       WHERE post_type = 'product'
         AND NOT EXISTS (
             SELECT 1 FROM wp_wc_product_meta_lookup 
             WHERE product_id = wp_posts.ID
         )
   );

   UPDATE wp_posts 
   SET post_status = 'trash'
   WHERE post_type = 'product'
     AND NOT EXISTS (
         SELECT 1 FROM wp_wc_product_meta_lookup 
         WHERE product_id = wp_posts.ID
     );

   -- 3. RESETEAZÄ‚ AUTO_INCREMENT
   SET @max_id = (SELECT MAX(ID) FROM wp_posts WHERE post_type = 'product');
   ALTER TABLE wp_posts AUTO_INCREMENT = @max_id + 1;

   -- 4. OPTIMIZEAZÄ‚ TABELE
   OPTIMIZE TABLE wp_posts;
   OPTIMIZE TABLE wp_postmeta;
   OPTIMIZE TABLE wp_wc_product_meta_lookup;


ğŸ“‹ PAÈ˜I RECOMANDAÈšI:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. âœ“ FÄƒ BACKUP la baza de date
   - cPanel â†’ phpMyAdmin â†’ SelecteazÄƒ DB â†’ Export (SQL)
   - SalveazÄƒ fiÈ™ierul local

2. âœ“ RuleazÄƒ una din metode (PHP Script sau MySQL Commands)

3. âœ“ VerificÄƒ rezultat
   - Mergi Ã®n WooCommerce â†’ Produse
   - Verific cÄƒ nu au rÄƒmas produse orfane

4. âœ“ GoleÅŸte Trash-ul
   - WooCommerce â†’ Produse â†’ Trash
   - SelecteazÄƒ toate â†’ Delete permanently

5. âœ“ Clear Cache
   - WooCommerce â†’ Status â†’ Tools
   - "Clear all transients" â†’ Run tool

6. âœ“ ReÃ®ncarcÄƒ pagina de Produse
   - WooCommerce â†’ Produse (refresh)

7. âœ“ ÃNCEARCÄ‚ DIN NOU importul
   - START_PROGRAM.bat
   - ImporteazÄƒ EAN-ul 107082005005
   - Ar trebui sÄƒ funcÈ›ioneze! âœ“


âš ï¸ ATENÈšII IMPORTANTE:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. âŒ NU È™terge manual ID 5081 din wp_posts
   - FoloseÈ™te scriptul/comenzile de sus
   - Trebuie È™terse È™i din postmeta È™i term_relationships

2. âŒ NU Ã®ncerca alt EAN dacÄƒ nu ai curÄƒÈ›at
   - Vor apÄƒrea iarÄƒÈ™i ID-uri orfane (5082, 5083, etc.)

3. âš ï¸ DacÄƒ foloseÈ™ti phpMyAdmin, verifi cÄƒ prefixul tabelei:
   - Poate fi "wp_" SAU "wplt_" SAU altceva
   - Vezi Ã®n cPanel care e prefixul tÄƒu

4. ğŸ’¾ BACKUP-URI regulate!
   - DupÄƒ curÄƒÈ›are, fÄƒ backup
   - UpdraftPlus SAU BackupBuddy


ğŸ¯ DUPA CURÄ‚ÈšARE:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. TesteazÄƒ conexiunea din Program:
   - START_PROGRAM.bat
   - Tab "Configurare" â†’ "Test conexiune"
   - Ar trebui "âœ“ Conexiune reuÈ™itÄƒ"

2. Importa un produs:
   - Pune EAN Ã®n sku_list.txt: 107082005005
   - Tab "Import Produse" â†’ "Start Import"
   - Log trebuie sÄƒ arate:
     âœ“ Produs creat cu succes! ID: XXXX
     âœ“ PRODUS CREAT È˜I SALVAT COMPLET!

3. VerificÄƒ Ã®n WooCommerce:
   - Admin â†’ Produse
   - CautÄƒ produsul cu EAN 107082005005
   - Verifi SKU: WEBGSM-005005-XXXX
   - Verifi meta_data: _ean = 107082005005


ğŸ“Š DIAGNOSTIC:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Daca ai nelamuriri, ruleazÄƒ acest query Ã®n phpMyAdmin:

-- Produse COMPLETE (OK)
SELECT COUNT(*) 
FROM wp_posts p
WHERE p.post_type = 'product'
  AND EXISTS (
      SELECT 1 FROM wp_wc_product_meta_lookup 
      WHERE product_id = p.ID
  );

-- Produse ORFANE (NU BINE)
SELECT COUNT(*) 
FROM wp_posts p
WHERE p.post_type = 'product'
  AND NOT EXISTS (
      SELECT 1 FROM wp_wc_product_meta_lookup 
      WHERE product_id = p.ID
  );

Ar trebui sÄƒ vezi:
- Produse COMPLETE: numÄƒrul de produse bune
- Produse ORFANE: 0 (zero!)


ğŸ†˜ CONTACTEAZÄ‚ DACÄ‚:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. âœ“ Ai dubii pe prefixul tabelei
2. âœ“ Script-ul PHP dÄƒ eroare
3. âœ“ DupÄƒ curÄƒÈ›are inca apare eroare
4. âœ“ Ai incurcata baza de date cumva

Trimite:
- Ecran cu eroarea exactÄƒ
- FiÈ™ierul din logs/ (copy-paste)
- Prefixul tabelei (din phpMyAdmin)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Ultima actualizare: 14 Ianuarie 2026
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
